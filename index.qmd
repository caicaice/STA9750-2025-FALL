---
title: "PROJECT1"
---

#### Upcoming Season of *Stranger Things*

Netflix will release the fifth and final season of its hit show *Stranger Things* at the end of 2025. In preparation for the release, prepare a press release highlighting the broad impact of the previous four seasons. Your press release should refer to both the total viewership, the length of popularity (how many weeks in the top 10) and the multinational appeal of previous seasons. You should also compare the impact of *Stranger Things* to other popular English-language TV shows to give a sense of its success.This is a Quarto website.

To learn more about Quarto websites visit <https://quarto.org/docs/websites>.

#### Commercial Success in India

As the most populated country in the world, India represents a major growth opportunity for Netflix. Prepare a press release highlighting Netflix’s recent successes in Hindi-language films and TV. If you assume that all Hindi-language viewing is from customers in India (a strong assumption!), you can use this viewership data to estimate the size of Netflix’s customer base in India: compute a few points and discuss the long term growth trends (if any).

Netflix Expands Spanish-Language Content After Record Global Growth

Los Angeles, CA – October 3, 2025 – Netflix today announced a major expansion of its Spanish-language catalog following record international viewership. In 2024, Spanish-language hits like Money Heist, Elite, and Berlin generated over 500 million hours viewed worldwide, making them among the top non-English shows globally. The company will launch 20 new Spanish-language originals in 2026 through partnerships with studios in Mexico City, Madrid, and Bogotá. This expansion aligns with Netflix’s strategy of leveraging local content to drive international growth.

### **Acquire Data**

```{r}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

```

### **Data Import**

```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)

str(GLOBAL_TOP_10)
glimpse(GLOBAL_TOP_10)
```

### **Data Cleaning**

```{r}
 GLOBAL_TOP_10 <- GLOBAL_TOP_10 |> mutate(season_title = if_else(season_title=="N/A",NA,season_title))
str(GLOBAL_TOP_10)
glimpse(GLOBAL_TOP_10)
```

### **Data Import**

```{r}
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = c("N/A", "NA"))
str(COUNTRY_TOP_10)
glimpse(COUNTRY_TOP_10)

# if (!require("DT")) install.packages('DT')
xfun::session_info('DT')


```

### **Initial Data Exploration**

```{r}
library(DT)
GLOBAL_TOP_10 |> 
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE))

library(stringr)
format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

GLOBAL_TOP_10 |> 
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))

GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

### **Exploratory Questions**

How many different countries does Netflix operate in?

```{r}
## 1

netflix_countries <- COUNTRY_TOP_10 |>
  distinct(country_name) |>
  n_distinct()

cat("Netflix operates in", netflix_countries, "countries.\n")

```

Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?

```{r}
## 2 
 GLOBAL_TOP_10 |>
    filter(category == 'Films (Non-English)') |>          
    filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10)) |>
    slice(which.max(cumulative_weeks_in_top_10)) |>
    select(show_title, cumulative_weeks_in_top_10)


```

What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?

```{r}
## 3
GLOBAL_TOP_10 |> 
    mutate(runtime_in_minutes = round(60 * runtime)) |>
    filter(category == "Films (English)" | category == "Films (Non-English)") |>
    select(category, show_title, runtime_in_minutes) |>
    slice_max(runtime_in_minutes)
```

For each of the four categories, what program has the most total hours of global viewership?

```{r}
##4

top_program <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarize(total_hours_viewed = sum(weekly_hours_viewed, na.rm = TRUE), .groups = 'drop') |>
  arrange(category, desc(total_hours_viewed)) |>
  group_by(category) |>
  slice(1) |>
  arrange(desc(total_hours_viewed)) |>
  slice(1)  

cat("The program with the most total hours of global viewership is", top_program$show_title, "in the", top_program$category, "category with", round(top_program$total_hours_viewed), "hours.\n")
```

Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?

```{r}
##5
longest_country_run <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "TV")) |>
  slice_max(cumulative_weeks_in_top_10, n = 1)

cat("The TV show with the longest run in a country's Top 10 is", longest_country_run$show_title, 
    "with", longest_country_run$cumulative_weeks_in_top_10, "weeks in", longest_country_run$country_name, ".\n")

```

Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?

```{r}
##6

result <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(weeks_count = n_distinct(week), last_week = max(week)) |>
  filter(weeks_count < 200) |>
  slice_min(weeks_count)

cat("The country with less than 200 weeks of data is", result$country_name, 
    "with", result$weeks_count, "weeks, last operating in", result$last_week, ".\n")
```

What is the total viewership of the TV show Squid Game? Note that there are three seasons total and we are looking for the total number of hours watched across all seasons.

```{r}
##7
squid_game_result <- GLOBAL_TOP_10 |>
  filter(str_detect(show_title, "Squid Game")) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))

cat("Squid Game total viewership:", scales::comma(squid_game_result$total_hours), "hours\n")
```

The movie Red Notice has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021?

How many Films reached Number 1 in the US but did not originally debut there? That is, find films that first appeared on the Top 10 chart at, e.g., Number 4 but then became more popular and eventually hit Number 1? What is the most recent film to pull this off?

Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?
